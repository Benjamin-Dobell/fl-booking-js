{"version":3,"file":"controller.js","sources":["node_modules/fl-assert/dist/assert.js","src/defaultConfig.js","src/utils.js","src/controller.js"],"sourcesContent":["// Bug checking function that will throw an error whenever\n// the condition sent to it is evaluated to false\n/**\n * Processes the message and outputs the correct message if the condition\n * is false. Otherwise it outputs null.\n * @api private\n * @method processCondition\n * @param  {Boolean} condition - Result of the evaluated condition\n * @param  {String} errorMessage - Message explainig the error in case it is thrown\n * @return {String | null}  - Error message if there is an error, nul otherwise.\n */\nfunction processCondition(condition, errorMessage) {\n  if (!condition) {\n    var completeErrorMessage = '';\n    var re = /at ([^\\s]+)\\s\\(/g;\n    var stackTrace = new Error().stack;\n    var stackFunctions = [];\n\n    var funcName = re.exec(stackTrace);\n    while (funcName && funcName[1]) {\n      stackFunctions.push(funcName[1]);\n      funcName = re.exec(stackTrace);\n    }\n\n    // Number 0 is processCondition itself,\n    // Number 1 is assert,\n    // Number 2 is the caller function.\n    if (stackFunctions[2]) {\n      completeErrorMessage = stackFunctions[2] + ': ' + completeErrorMessage;\n    }\n\n    completeErrorMessage += errorMessage;\n    return completeErrorMessage;\n  }\n\n  return null;\n}\n\n/**\n * Throws an error if the boolean passed to it evaluates to false.\n * To be used like this:\n * \t\tassert(myDate !== undefined, \"Date cannot be undefined.\");\n * @api public\n * @method assert\n * @param  {Boolean} condition - Result of the evaluated condition\n * @param  {String} errorMessage - Message explainig the error in case it is thrown\n * @return void\n */\nfunction assert(condition, errorMessage) {\n  var error = processCondition(condition, errorMessage);\n  if (typeof error === 'string') {\n    throw new Error(error);\n  }\n}\n\n/**\n * Logs a warning if the boolean passed to it evaluates to false.\n * To be used like this:\n * \t\tassert.warn(myDate !== undefined, \"No date provided.\");\n * @api public\n * @method warn\n * @param  {Boolean} condition - Result of the evaluated condition\n * @param  {String} errorMessage - Message explainig the error in case it is thrown\n * @return void\n */\nassert.warn = function warn(condition, errorMessage) {\n  var error = processCondition(condition, errorMessage);\n  if (typeof error === 'string') {\n    console.warn(error);\n  }\n};\n\nexport default assert;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJhc3NlcnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQnVnIGNoZWNraW5nIGZ1bmN0aW9uIHRoYXQgd2lsbCB0aHJvdyBhbiBlcnJvciB3aGVuZXZlclxuLy8gdGhlIGNvbmRpdGlvbiBzZW50IHRvIGl0IGlzIGV2YWx1YXRlZCB0byBmYWxzZVxuLyoqXG4gKiBQcm9jZXNzZXMgdGhlIG1lc3NhZ2UgYW5kIG91dHB1dHMgdGhlIGNvcnJlY3QgbWVzc2FnZSBpZiB0aGUgY29uZGl0aW9uXG4gKiBpcyBmYWxzZS4gT3RoZXJ3aXNlIGl0IG91dHB1dHMgbnVsbC5cbiAqIEBhcGkgcHJpdmF0ZVxuICogQG1ldGhvZCBwcm9jZXNzQ29uZGl0aW9uXG4gKiBAcGFyYW0gIHtCb29sZWFufSBjb25kaXRpb24gLSBSZXN1bHQgb2YgdGhlIGV2YWx1YXRlZCBjb25kaXRpb25cbiAqIEBwYXJhbSAge1N0cmluZ30gZXJyb3JNZXNzYWdlIC0gTWVzc2FnZSBleHBsYWluaWcgdGhlIGVycm9yIGluIGNhc2UgaXQgaXMgdGhyb3duXG4gKiBAcmV0dXJuIHtTdHJpbmcgfCBudWxsfSAgLSBFcnJvciBtZXNzYWdlIGlmIHRoZXJlIGlzIGFuIGVycm9yLCBudWwgb3RoZXJ3aXNlLlxuICovXG5mdW5jdGlvbiBwcm9jZXNzQ29uZGl0aW9uKGNvbmRpdGlvbiwgZXJyb3JNZXNzYWdlKSB7XG4gIGlmICghY29uZGl0aW9uKSB7XG4gICAgbGV0IGNvbXBsZXRlRXJyb3JNZXNzYWdlID0gJyc7XG4gICAgY29uc3QgcmUgPSAvYXQgKFteXFxzXSspXFxzXFwoL2c7XG4gICAgY29uc3Qgc3RhY2tUcmFjZSA9IG5ldyBFcnJvcigpLnN0YWNrO1xuICAgIGNvbnN0IHN0YWNrRnVuY3Rpb25zID0gW107XG5cbiAgICBsZXQgZnVuY05hbWUgPSByZS5leGVjKHN0YWNrVHJhY2UpO1xuICAgIHdoaWxlIChmdW5jTmFtZSAmJiBmdW5jTmFtZVsxXSkge1xuICAgICAgc3RhY2tGdW5jdGlvbnMucHVzaChmdW5jTmFtZVsxXSk7XG4gICAgICBmdW5jTmFtZSA9IHJlLmV4ZWMoc3RhY2tUcmFjZSk7XG4gICAgfVxuXG4gICAgLy8gTnVtYmVyIDAgaXMgcHJvY2Vzc0NvbmRpdGlvbiBpdHNlbGYsXG4gICAgLy8gTnVtYmVyIDEgaXMgYXNzZXJ0LFxuICAgIC8vIE51bWJlciAyIGlzIHRoZSBjYWxsZXIgZnVuY3Rpb24uXG4gICAgaWYgKHN0YWNrRnVuY3Rpb25zWzJdKSB7XG4gICAgICBjb21wbGV0ZUVycm9yTWVzc2FnZSA9IGAke3N0YWNrRnVuY3Rpb25zWzJdfTogJHtjb21wbGV0ZUVycm9yTWVzc2FnZX1gO1xuICAgIH1cblxuICAgIGNvbXBsZXRlRXJyb3JNZXNzYWdlICs9IGVycm9yTWVzc2FnZTtcbiAgICByZXR1cm4gY29tcGxldGVFcnJvck1lc3NhZ2U7XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGJvb2xlYW4gcGFzc2VkIHRvIGl0IGV2YWx1YXRlcyB0byBmYWxzZS5cbiAqIFRvIGJlIHVzZWQgbGlrZSB0aGlzOlxuICogXHRcdGFzc2VydChteURhdGUgIT09IHVuZGVmaW5lZCwgXCJEYXRlIGNhbm5vdCBiZSB1bmRlZmluZWQuXCIpO1xuICogQGFwaSBwdWJsaWNcbiAqIEBtZXRob2QgYXNzZXJ0XG4gKiBAcGFyYW0gIHtCb29sZWFufSBjb25kaXRpb24gLSBSZXN1bHQgb2YgdGhlIGV2YWx1YXRlZCBjb25kaXRpb25cbiAqIEBwYXJhbSAge1N0cmluZ30gZXJyb3JNZXNzYWdlIC0gTWVzc2FnZSBleHBsYWluaWcgdGhlIGVycm9yIGluIGNhc2UgaXQgaXMgdGhyb3duXG4gKiBAcmV0dXJuIHZvaWRcbiAqL1xuZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbiwgZXJyb3JNZXNzYWdlKSB7XG4gIGNvbnN0IGVycm9yID0gcHJvY2Vzc0NvbmRpdGlvbihjb25kaXRpb24sIGVycm9yTWVzc2FnZSk7XG4gIGlmICh0eXBlb2YgZXJyb3IgPT09ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTtcbiAgfVxufVxuXG4vKipcbiAqIExvZ3MgYSB3YXJuaW5nIGlmIHRoZSBib29sZWFuIHBhc3NlZCB0byBpdCBldmFsdWF0ZXMgdG8gZmFsc2UuXG4gKiBUbyBiZSB1c2VkIGxpa2UgdGhpczpcbiAqIFx0XHRhc3NlcnQud2FybihteURhdGUgIT09IHVuZGVmaW5lZCwgXCJObyBkYXRlIHByb3ZpZGVkLlwiKTtcbiAqIEBhcGkgcHVibGljXG4gKiBAbWV0aG9kIHdhcm5cbiAqIEBwYXJhbSAge0Jvb2xlYW59IGNvbmRpdGlvbiAtIFJlc3VsdCBvZiB0aGUgZXZhbHVhdGVkIGNvbmRpdGlvblxuICogQHBhcmFtICB7U3RyaW5nfSBlcnJvck1lc3NhZ2UgLSBNZXNzYWdlIGV4cGxhaW5pZyB0aGUgZXJyb3IgaW4gY2FzZSBpdCBpcyB0aHJvd25cbiAqIEByZXR1cm4gdm9pZFxuICovXG5hc3NlcnQud2FybiA9IGZ1bmN0aW9uIHdhcm4oY29uZGl0aW9uLCBlcnJvck1lc3NhZ2UpIHtcbiAgY29uc3QgZXJyb3IgPSBwcm9jZXNzQ29uZGl0aW9uKGNvbmRpdGlvbiwgZXJyb3JNZXNzYWdlKTtcbiAgaWYgKHR5cGVvZiBlcnJvciA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25zb2xlLndhcm4oZXJyb3IpO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBhc3NlcnQ7XG4iXSwiZmlsZSI6ImFzc2VydC5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9\n","/* globals moment */\n\nmodule.exports = {\n  targetEl: null,\n  name: 'Book an interview',\n  email: 'info@slvolunteers.com',\n  calendar: 'Interviews',\n  apiToken: 'xxx',\n  showCredits: false,\n  // Display and scroll to the first upcoming event in the calendar\n  goToFirstEvent: false,\n  // 'instant' 'confirm_decline'. Controls message after booking confirmation.\n  bookingGraph: 'confirm_decline',\n  fullCalendar: {\n    weekends: false,\n    businessHours: true,\n    views: {\n      agenda: {\n        displayEventEnd: false,\n        columnFormat: 'ddd\\nMMM D',\n      },\n    },\n  },\n  timekitCreateBooking: {\n    event: {\n      // Default, you may want to customize this to a specific location,\n      where: 'Online',\n      // Inserted dynamically based on the host and visitors names\n      // (you can replace it with a static string)\n      what: 'Interview',\n    },\n    customer: {\n      id: 'XXXXXXX user id XXXXXXXX',\n      timezone: moment.tz.guess(),\n    },\n  },\n  avatar: 'avatar.jpg', // This prevents the template from breaking\n};\n","/**\n * Checks if an element or up to 4 of its parents have a class;\n * @function parentHasClass\n * @param  {String} className\n * @param  {HTMLElement} el\n * @param  {number} counter [optional]\n * @return {Boolean}\n */\nfunction parentHasClass(className, el, counter = 0) { // eslint-disable-line complexity\n  const maxIterations = 5;\n  if (!el || !el.classList || counter >= maxIterations) {\n    return false;\n  }\n\n  return el.classList.contains(className)\n    ? true\n    : parentHasClass(className, el.parentNode, counter + 1);\n}\n\n/**\n * Auto-complete calendar booking fields when data is available.\n * @function setAutoFillForm\n */\nfunction setAutoFillForm(rootEl, name, email) {\n  if (!(name && email)) {\n    return;\n  }\n\n  rootEl.addEventListener('click', e => {\n    if (!parentHasClass('fc-time-grid-event', e.target)) {\n      return;\n    }\n\n    function fillValues() {\n      const nameInput = document.querySelector('.bookingjs-form-input[name=name]');\n      const emailInput = document.querySelector('.bookingjs-form-input[name=email]');\n\n      if (nameInput && emailInput) {\n        nameInput.value = name;\n        emailInput.value = email;\n      }\n    }\n\n    setTimeout(fillValues, 200);\n  });\n}\n\nexport default {\n  setAutoFillForm,\n};\n","/* globals TimekitBooking, moment, xController, $LAB */\nimport assert from 'fl-assert';\nimport defaultConfig from './defaultConfig';\nimport utils from './utils';\n\n//------------------------------------------------------\n// Controll scheduling widget\n//------------------------------------------------------\nfunction flBooking(config = {}) {\n  // Dependency check\n  ['moment', 'jQuery'].forEach(dep => assert(window[dep], `Dependency ${dep} not found.`));\n\n  const {\n    autofillUser,\n    autofillEmail,\n    timezone,\n    targetEl,\n    createBooking,\n    getEvents,\n  } = config;\n\n  assert(\n    timezone && timezone.timezone && timezone.utc_offset,\n    'Invalid timezone object'\n  );\n\n  // This string will be replaced by the actual id\n  const scheduler = window['$$ scheduler id $$'];\n  scheduler.setCreateBooking(createBooking);\n  scheduler.setFindTime(getEvents);\n  scheduler.setUserTimezone(timezone);\n\n  const configuration = Object.assign({}, defaultConfig, { targetEl });\n  new TimekitBooking().init(configuration);\n\n  utils.setAutoFillForm(targetEl, autofillUser, autofillEmail);\n}\n\nexport default flBooking;\n"],"names":["moment","tz","guess","parentHasClass","className","el","counter","maxIterations","classList","contains","parentNode","setAutoFillForm","rootEl","name","email","addEventListener","e","target","fillValues","nameInput","document","querySelector","emailInput","value","flBooking","config","forEach","assert","window","dep","autofillUser","autofillEmail","timezone","targetEl","createBooking","getEvents","utc_offset","scheduler","setCreateBooking","setFindTime","setUserTimezone","configuration","Object","assign","defaultConfig","TimekitBooking","init"],"mappings":"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"}