{"version":3,"file":"scheduler.js","sources":["src/scheduler.js"],"sourcesContent":["/* global moment */\n/**\n *\n * This file replaces the original scheduler object used by Timekit.io\n * A compilation step substitutes the original reference to a reference\n * to this object.\n *\n */\nfunction request(method, url, data) {\n  const config = { method };\n\n  if (method.toUpperCase() === 'POST') {\n    config.body = JSON.stringify(data);\n  }\n\n  return fetch(url, config)\n    .then((res) => res.json())\n    .then((json) => json);\n}\n\nconst urlPath = path => `${window.APIGLOBAL}${path}`;\n\nfunction findTime() {\n  return request('GET', urlPath('/findtime'));\n}\n\nfunction getUserTimezone() {\n  return Promise.resolve({\n    data: {\n      timezone: moment.tz.guess(),\n      utc_offset: moment().utcOffset(),\n    },\n  });\n}\n\n\nconst listeners = [];\nconst scheduler = {\n  configure() { return this; },\n  setUser() { return this; },\n  include() { return this; },\n  headers() { return this; },\n  findTime,\n  getUserTimezone,\n  createBooking: data => {\n    const results = listeners.map(f => f(data));\n    return Promise.resolve(results[0]);\n  },\n  onCreateBooking: f => listeners.push(f),\n};\n\nmodule.exports = scheduler;\n"],"names":["request","method","url","data","config","toUpperCase","body","JSON","stringify","fetch","then","res","json","urlPath","window","APIGLOBAL","path","findTime","getUserTimezone","Promise","resolve","moment","tz","guess","utcOffset","listeners","scheduler","results","map","f","push"],"mappings":";;;;;;AAAA;;;;;;;;AAQA,SAASA,OAAT,CAAiBC,MAAjB,EAAyBC,GAAzB,EAA8BC,IAA9B,EAAoC;MAC5BC,SAAS,EAAEH,cAAF,EAAf;;MAEIA,OAAOI,WAAP,OAAyB,MAA7B,EAAqC;WAC5BC,IAAP,GAAcC,KAAKC,SAAL,CAAeL,IAAf,CAAd;;;SAGKM,MAAMP,GAAN,EAAWE,MAAX,EACJM,IADI,CACC,UAACC,GAAD;WAASA,IAAIC,IAAJ,EAAT;GADD,EAEJF,IAFI,CAEC,UAACE,IAAD;WAAUA,IAAV;GAFD,CAAP;;;AAKF,IAAMC,UAAU,SAAVA,OAAU;cAAWC,OAAOC,SAAlB,GAA8BC,IAA9B;CAAhB;;AAEA,SAASC,QAAT,GAAoB;SACXjB,QAAQ,KAAR,EAAea,QAAQ,WAAR,CAAf,CAAP;;;AAGF,SAASK,eAAT,GAA2B;SAClBC,QAAQC,OAAR,CAAgB;UACf;gBACMC,OAAOC,EAAP,CAAUC,KAAV,EADN;kBAEQF,SAASG,SAAT;;GAHT,CAAP;;;AASF,IAAMC,YAAY,EAAlB;AACA,IAAMC,YAAY;WAAA,uBACJ;WAAS,IAAP;GADE;SAAA,qBAEN;WAAS,IAAP;GAFI;SAAA,qBAGN;WAAS,IAAP;GAHI;SAAA,qBAIN;WAAS,IAAP;GAJI;;oBAAA;kCAAA;iBAOD,6BAAQ;QACfC,UAAUF,UAAUG,GAAV,CAAc;aAAKC,EAAE1B,IAAF,CAAL;KAAd,CAAhB;WACOgB,QAAQC,OAAR,CAAgBO,QAAQ,CAAR,CAAhB,CAAP;GATc;mBAWC;WAAKF,UAAUK,IAAV,CAAeD,CAAf,CAAL;;CAXnB;;AAcA,kBAAiBH,SAAjB;;;;"}